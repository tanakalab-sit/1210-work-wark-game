<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Éü„Éã„Ç≤„Éº„É†ÈõÜ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Mochiy+Pop+One&display=swap');

        :root {
            --primary-color: #ff69b4; /* Pink */
            --secondary-color: #1e90ff; /* DodgerBlue */
            --accent-color: #ffd700; /* Gold */
            --text-color: #333;
            --bg-color: #f0f8ff; /* AliceBlue */
        }

        body {
            font-family: 'Mochiy+Pop+One', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            overflow: hidden;
            text-align: center;
            user-select: none;
        }
        
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7); z-index: 300;
            display: none; /* Initially hidden */
            justify-content: center; align-items: center; flex-direction: column;
            opacity: 0; transition: opacity 0.5s;
        }
        .overlay.visible {
            display: flex;
            opacity: 1;
        }

        .dialog-box {
            background: white; padding: 30px; border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); text-align: center;
            max-width: 90%;
        }

        .dialog-box h2 { color: var(--secondary-color); margin-top: 0; }
        .dialog-box button {
            font-family: 'Mochiy Pop One', sans-serif; font-size: 1.5em; padding: 15px 30px;
            border-radius: 10px; border: none; background: var(--primary-color);
            color: white; cursor: pointer; transition: background 0.2s; margin: 10px;
        }
        .dialog-box button:hover { background: #d65b99; }

        .game-container { display: none; }
        .game-container.active { display: block; }
        
        /* Background */
        .background-shapes { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; }
        .background-shapes div { position: absolute; border-radius: 50%; background: rgba(255, 105, 180, 0.2); animation: float-bg 10s ease-in-out infinite; }
        .background-shapes div:nth-child(1){ width: 80px; height: 80px; left: 10%; animation-duration: 15s; }
        .background-shapes div:nth-child(2){ width: 120px; height: 120px; left: 20%; animation-duration: 12s; animation-delay: 2s; background: rgba(30, 144, 255, 0.2); }
        .background-shapes div:nth-child(3){ width: 50px; height: 50px; left: 40%; animation-duration: 18s; animation-delay: 5s; }
        .background-shapes div:nth-child(4){ width: 150px; height: 150px; left: 60%; animation-duration: 10s; background: rgba(255, 215, 0, 0.2); }
        .background-shapes div:nth-child(5){ width: 70px; height: 70px; left: 85%; animation-duration: 16s; animation-delay: 3s; }
        .background-shapes div:nth-child(6){ width: 90px; height: 90px; left: 5%; animation-duration: 13s; animation-delay: 7s; background: rgba(144, 238, 144, 0.2); }
        @keyframes float-bg { from { transform: translateY(100vh) scale(1); } to { transform: translateY(-150px) scale(1.2); } }

        /* Clicker Game */
        #clicker-game-container { position: relative; max-width: 800px; margin: auto; }
        #score-container { font-size: 2.5em; font-weight: bold; color: var(--primary-color); text-shadow: 2px 2px 4px rgba(0,0,0,0.1); }
        #target-score-display { font-size: 1em; color: var(--secondary-color); margin-bottom: 10px; }
        #typing-display-container { background: rgba(255,255,255,0.7); padding: 5px 15px; border-radius: 20px; display: inline-block; margin-bottom: 10px; height: 30px; line-height: 30px; min-width: 200px; border: 2px solid var(--secondary-color); }
        #typing-display { font-size: 1.2em; letter-spacing: 2px; color: var(--secondary-color); }
        #balloon-container { position: relative; width: 200px; height: 250px; margin: 20px auto; cursor: pointer; transition: transform 0.1s ease; }
        #balloon-container:active { transform: scale(0.95); }
        #balloon { width: 100%; height: 100%; background-color: var(--primary-color); border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%; position: relative; animation: float 5s ease-in-out infinite; box-shadow: inset -10px -10px 0 rgba(0,0,0,0.1); }
        #balloon::after { content: ''; position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-top: 20px solid var(--primary-color); }
        @keyframes float { 0% { transform: translateY(0); } 50% { transform: translateY(-20px); } 100% { transform: translateY(0); } }
        .particle { position: absolute; top: 50%; left: 50%; background-color: var(--primary-color); border-radius: 50%; opacity: 0; pointer-events: none; transform: translate(-50%, -50%); }
        #character-display { position: fixed; bottom: 20px; left: 20px; background: rgba(255, 255, 224, 0.9); border: 3px solid var(--accent-color); border-radius: 15px; padding: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); max-width: 250px; display: none; align-items: center; gap: 10px; }
        #character-image-ingame { font-size: 3em; }
        #character-name { font-size: 1.2em; font-weight: bold; color: var(--accent-color); }
        #character-effect { font-size: 0.9em; margin-top: 5px; }
        #setup-overlay .dialog-box { width: 800px; }
        #character-selection { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 15px; }
        .character-card { border: 3px solid #eee; border-radius: 10px; padding: 15px; cursor: pointer; transition: all 0.2s ease-out; background: #f9f9f9; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; }
        .character-card:hover { transform: translateY(-5px) scale(1.03); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
        .character-card.selected { border-color: var(--accent-color); background: #fffbeb; transform: scale(1.05); box-shadow: 0 0 20px var(--accent-color); }
        .character-image { font-size: 2.5em; margin-bottom: 10px; }
        .character-card-name { font-weight: bold; font-size: 1em; }
        .character-card-desc { font-size: 0.8em; margin-top: 8px; height: 45px; color: #555; }
        #target-score-input { width: 150px; font-size: 1.2em; padding: 5px; text-align: center; border: 2px solid #ccc; border-radius: 5px; margin-left: 10px; }
        #run-clicker-game-btn { margin-top: 20px; }
        
        /* Number Game */
        #number-game-container { text-align: center; }
        #number-game-status { font-size: 2em; margin-bottom: 20px; height: 60px; }
        #number-game-choices { display: flex; justify-content: center; gap: 20px; margin: 20px 0; }
        #number-game-choices button { font-size: 3em; width: 100px; height: 100px; }
        #number-game-info { display: flex; justify-content: space-around; width: 100%; max-width: 500px; margin: 20px auto; font-size: 1.5em; }

        /* Cheats, Fortune, Credits */
        #settings-panel { position: fixed; top: 20px; right: 20px; background: #fff; padding: 20px; border: 2px solid var(--secondary-color); border-radius: 10px; box-shadow: 0 0 15px rgba(0,0,0,0.2); z-index: 100; display: none; width: 250px; text-align: left; }
        #settings-panel h3 { margin-top: 0; text-align: center;}
        #settings-panel div { margin-bottom: 10px; }
        #settings-panel button { width: 100%; padding: 5px; font-family: 'Mochiy Pop One', sans-serif; }
        #settings-panel input { width: 95%; }
        #fortune-overlay .dialog-box { width: 500px; }
        #fortune-overlay p:first-child { font-size: 2em; }
        #fortune-rank { font-size: 7em; color: var(--accent-color); margin: 20px 0; text-shadow: 0 0 20px var(--accent-color); }
        #fortune-comment { font-size: 1.5em; }
        #show-credits-button { font-size: 1.2em; padding: 10px 20px; margin-top: 30px; cursor: pointer; }
        #credits-overlay { background: #000; z-index: 201; }
        #credits-content { position: absolute; top: 100%; width: 80%; max-width: 800px; text-align: justify; color: #feda4a; font-size: 2.5em; transform-origin: 50% 100%; animation: scroll-credits 60s linear forwards; }
        #credits-text p { margin: 1.5em 0; }
        @keyframes scroll-credits { from { top: 100%; transform: perspective(300px) rotateX(20deg); } to { top: -250%; transform: perspective(300px) rotateX(20deg); } }
        .shake-screen { animation: shake 0.8s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }
    </style>
</head>
<body>
    <div class="background-shapes">
        <div></div><div></div><div></div><div></div><div></div><div></div>
    </div>

    <!-- Mode Selection -->
    <div id="mode-selection-overlay" class="overlay">
        <div class="dialog-box">
            <h2>„Ç≤„Éº„É†„É¢„Éº„Éâ„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑ</h2>
            <button id="start-clicker-game-btn">„ÇØ„É™„ÉÉ„Ç´„Éº„Ç≤„Éº„É†</button>
            <button id="start-number-game-btn">Êï∞Â≠óÈÅ∏„Å≥„Ç≤„Éº„É†</button>
        </div>
    </div>

    <!-- Clicker Game Setup -->
    <div id="setup-overlay" class="overlay">
        <div class="dialog-box">
            <h2>„ÇØ„É™„ÉÉ„Ç´„Éº„Ç≤„Éº„É†Ë®≠ÂÆö</h2>
            <div class="setup-section">
                <label for="target-score-input">ÁõÆÊ®ô„Çπ„Ç≥„Ç¢:</label>
                <input type="number" id="target-score-input" value="1000" min="100">
            </div>
            <div class="setup-section">
                <h3>„Çµ„Éù„Éº„Éà„Ç≠„É£„É©„ÇíÈÅ∏„Å∂</h3>
                <div id="character-selection"></div>
            </div>
            <button id="run-clicker-game-btn">„Ç≤„Éº„É†ÈñãÂßãÔºÅ</button>
        </div>
    </div>

    <!-- Clicker Game Main -->
    <div id="clicker-game-container" class="game-container">
        <div id="score-container">„Çπ„Ç≥„Ç¢: <span id="score">0</span></div>
        <div id="target-score-display">ÁõÆÊ®ô: <span id="target-score">0</span></div>
        <div id="typing-display-container">ÂÖ•Âäõ‰∏≠: <span id="typing-display"></span></div>
        <div id="balloon-container"><div id="balloon"></div></div>
    </div>
    <div id="character-display">
        <div id="character-image-ingame"></div>
        <div id="character-info">
            <div id="character-name"></div>
            <div id="character-effect"></div>
        </div>
    </div>

    <!-- Number Game Main -->
    <div id="number-game-container" class="game-container">
        <h1>Êï∞Â≠ó„Åã„Å∂„Çä„Ç≤„Éº„É†</h1>
        <div id="number-game-status">Áõ∏Êâã„ÅÆÂá∫„ÅôÊï∞Â≠ó„Çí‰∫àÊ∏¨„Åó„Å¶„ÄÅÈÅï„ÅÜÊï∞Â≠ó„ÇíÈÅ∏„ÅπÔºÅ</div>
        <div id="number-game-info">
            <div id="number-game-score">„Çπ„Ç≥„Ç¢: 0</div>
            <div id="number-game-life">„É©„Ç§„Éï: ‚ô•‚ô•‚ô•</div>
        </div>
        <div id="number-game-choices">
            <button>1</button><button>2</button><button>3</button><button>4</button>
        </div>
    </div>

    <!-- Common overlays -->
    <div id="settings-panel">
        <h3>„ÉÅ„Éº„Éà„É¢„Éº„Éâ</h3>
        <div><button id="cheat-add-score">„Çπ„Ç≥„Ç¢Âä†ÁÆó</button></div>
        <div><label>„ÇØ„É™„ÉÉ„ÇØ„Éë„ÉØ„Éº: <input type="number" id="cheat-click-power"></label></div>
        <div><label>Ëá™Âãï„ÇØ„É™„ÉÉ„ÇØ(ms): <input type="range" id="cheat-auto-click" min="50" max="2000" value="2000" step="50"></label></div>
    </div>
    <div id="fortune-overlay" class="overlay">
        <div class="dialog-box">
            <p>‰ªäÊó•„ÅÆ„ÅÇ„Å™„Åü„ÅÆÈÅãÂã¢„ÅØ‚Ä¶</p>
            <h1 id="fortune-rank"></h1>
            <p id="fortune-comment"></p>
            <button id="show-credits-button">„Åù„Åó„Å¶‚Ä¶</button>
        </div>
    </div>
    <div id="credits-overlay" class="overlay">
        <div id="credits-content">
            <section id="credits-text">
                <p>„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ„ÅÇ-</p>
            </section>
        </div>
    </div>

    <script>
        // --- Global Elements ---
        const modeSelectionOverlay = document.getElementById('mode-selection-overlay');
        const clickerGameContainer = document.getElementById('clicker-game-container');
        const numberGameContainer = document.getElementById('number-game-container');
        const settingsPanel = document.getElementById('settings-panel');
        const fortuneOverlay = document.getElementById('fortune-overlay');
        const creditsOverlay = document.getElementById('credits-overlay');

        // --- Utility Functions ---
        function showOverlay(overlay, show = true) {
            if(show) {
                overlay.classList.add('visible');
            } else {
                overlay.classList.remove('visible');
            }
        }

        function startCredits() {
            showOverlay(fortuneOverlay, false);
            // Defer showing credits to the next paint cycle to ensure the transition starts correctly.
            setTimeout(() => {
                showOverlay(creditsOverlay, true);
            }, 10); // A very small delay is sometimes more robust than 0
        }
        document.getElementById('show-credits-button').onclick = startCredits;
        
        let activeGame = null;

        // --- Number Game Logic ---
        const numberGame = {
            state: { score: 0, life: 3 },
            statusEl: document.getElementById('number-game-status'),
            scoreEl: document.getElementById('number-game-score'),
            lifeEl: document.getElementById('number-game-life'),
            choiceButtons: document.querySelectorAll('#number-game-choices button'),

            init() {
                activeGame = this;
                this.state.score = 0;
                this.state.life = 3;
                this.updateUI();
                numberGameContainer.classList.add('active');
                this.statusEl.textContent = 'Áõ∏Êâã„ÅÆÂá∫„ÅôÊï∞Â≠ó„Çí‰∫àÊ∏¨„Åó„Å¶„ÄÅÈÅï„ÅÜÊï∞Â≠ó„ÇíÈÅ∏„ÅπÔºÅ';
                this.choiceButtons.forEach(btn => btn.disabled = false);
            },
            playerSelect(playerNum) {
                if (this.state.life <= 0) return;

                const cpuNum = Math.floor(Math.random() * 4) + 1;
                if (playerNum === cpuNum) {
                    this.state.life--;
                    this.statusEl.innerHTML = `ÊÆãÂøµÔºÅÁõ∏Êâã„ÇÇ <span style="color:red; font-size: 1.5em;">${cpuNum}</span> „ÇíÈÅ∏„Çì„Å†ÔºÅ`;
                } else {
                    this.state.score += 100;
                    this.statusEl.innerHTML = `ÂãùÂà©ÔºÅÁõ∏Êâã„ÅØ <span style="color:blue; font-size: 1.5em;">${cpuNum}</span> „Å†„Å£„Åü„ÄÇ`;
                }
                this.updateUI();

                if (this.state.life <= 0) {
                    this.gameOver();
                }
            },
            updateUI() {
                this.scoreEl.textContent = `„Çπ„Ç≥„Ç¢: ${this.state.score}`;
                this.lifeEl.textContent = `„É©„Ç§„Éï: ${'‚ô•'.repeat(this.state.life)}`;
            },
            gameOver() {
                this.statusEl.textContent = `„Ç≤„Éº„É†„Ç™„Éº„Éê„ÉºÔºÅÊúÄÁµÇ„Çπ„Ç≥„Ç¢: ${this.state.score}`;
                this.choiceButtons.forEach(btn => btn.disabled = true);
                setTimeout(startCredits, 3000);
            },
            setup() {
                this.choiceButtons.forEach(btn => {
                    btn.addEventListener('click', () => this.playerSelect(parseInt(btn.textContent)));
                });
            }
        };

        // --- Clicker Game Logic ---
        const clickerGame = {
            score: 0, clickValue: 1, clickCount: 0, targetScore: 1000,
            wordInput: '', cheatInput: '',
            selectedCharacter: null, autoClickInterval: null, gameActive: false,
            elements: {
                scoreEl: document.getElementById('score'),
                balloonContainer: document.getElementById('balloon-container'),
                characterDisplay: document.getElementById('character-display'),
                characterImageIngame: document.getElementById('character-image-ingame'),
                characterNameEl: document.getElementById('character-name'),
                characterEffectEl: document.getElementById('character-effect'),
                typingDisplay: document.getElementById('typing-display'),
                setupOverlay: document.getElementById('setup-overlay'),
                targetScoreInput: document.getElementById('target-score-input'),
                characterSelection: document.getElementById('character-selection'),
                runButton: document.getElementById('run-clicker-game-btn'),
                targetScoreDisplay: document.getElementById('target-score'),
            },
            characters: [
                { id: 'hippo', name: '„ÅÆ„Çì„Å≥„Çä„Ç´„Éê', image: 'ü¶õ', effect: 'clickMultiplier', value: 1.1, description: '„ÇØ„É™„ÉÉ„ÇØ„ÅÆ„Çπ„Ç≥„Ç¢„Åå1.1ÂÄç' },
                { id: 'beaver', name: '„Åæ„ÇÅ„Åæ„ÇÅ„Éì„Éº„Éê„Éº', image: 'ü¶´', effect: 'bonusOnClick', value: 15, description: '15„ÇØ„É™„ÉÉ„ÇØÊØé„Å´„Éú„Éº„Éä„Çπ' },
                { id: 'seal', name: '„Åî„Çç„Åî„Çç„Ç¢„Ç∂„É©„Ç∑', image: 'ü¶≠', effect: 'baseClickUp', value: 1, description: '„ÇØ„É™„ÉÉ„ÇØ„ÅÆÂü∫Á§éÁÇπ„Åå+1' },
                { id: 'alpaca', name: '„ÇÇ„Åµ„ÇÇ„Åµ„Ç¢„É´„Éë„Ç´', image: 'ü¶ô', effect: 'clickMultiplier', value: 1.2, description: '„Çπ„Ç≥„Ç¢„Åå1.2ÂÄç„Å†„ÅåÂü∫Á§éÁÇπ-1' },
                { id: 'capybara', name: '„Åä„Å†„ÇÑ„Åã„Ç´„Éî„Éê„É©', image: 'ü¶¶', effect: 'reduceTarget', value: 0.9, description: 'ÁõÆÊ®ô„Çπ„Ç≥„Ç¢„Åå10%Ê∏õ„Çã' },
                { id: 'penguin', name: '„Éö„É≥„ÇÆ„É≥ÈÉ®Èöä', image: 'üêß', effect: 'autoClick', value: 1, description: '1Áßí„Åî„Å®„Å´Ëá™Âãï„Åß1„Çπ„Ç≥„Ç¢Âä†ÁÆó' },
                { id: 'owl', name: 'ÂçöË≠ò„Éï„ÇØ„É≠„Ç¶', image: 'ü¶â', effect: 'cheatUp', value: 1.5, description: '„ÉÅ„Éº„Éà„Ç≥„Éû„É≥„Éâ„ÅÆÂäπÊûú„Åå1.5ÂÄç' },
                { id: 'dinosaur', name: '„ÉÄ„Ç§„Éä„ÇΩ„Éº', image: 'ü¶ñ', effect: 'superClick', value: 50, description: '50„ÇØ„É™„ÉÉ„ÇØÊØé„Å´Ë∂ÖÂº∑Âäõ„Å™„ÇØ„É™„ÉÉ„ÇØ' },
                { id: 'quokka', name: '„ÇØ„Ç¢„ÉÉ„Ç´„ÉØ„É©„Éì„Éº', image: 'üê®', effect: 'randomBonus', value: 0.02, description: '2%„ÅÆÁ¢∫Áéá„ÅßË∂Ö„É©„ÉÉ„Ç≠„Éº„Éú„Éº„Éä„Çπ' },
                { id: 'shoebill', name: '„Éè„Ç∑„Éì„É≠„Ç≥„Ç¶', image: 'üê¶', effect: 'none', value: 0, description: 'Áâπ„Å´‰Ωï„ÇÇ„Åó„Å™„ÅÑ„ÄÇ„Åü„Å†Ë¶ã„Å¶„ÅÑ„Çã„ÄÇ' },
            ],
            
            init() {
                activeGame = this;
                showOverlay(this.elements.setupOverlay, true);
            },
            run() {
                const scoreInput = parseInt(this.elements.targetScoreInput.value);
                this.targetScore = (!isNaN(scoreInput) && scoreInput >= 100) ? scoreInput : 1000;
                
                if (!this.selectedCharacter) { alert('„Çµ„Éù„Éº„Éà„Ç≠„É£„É©„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºÅ'); return; }

                this.applyCharacterEffect();
                this.elements.targetScoreDisplay.textContent = Math.floor(this.targetScore);
                
                this.elements.characterImageIngame.textContent = this.selectedCharacter.image;
                this.elements.characterNameEl.textContent = this.selectedCharacter.name;
                this.elements.characterEffectEl.textContent = this.selectedCharacter.description;
                this.elements.characterDisplay.style.display = 'flex';

                this.gameActive = true;
                showOverlay(this.elements.setupOverlay, false);
                clickerGameContainer.classList.add('active');

                if (this.selectedCharacter.effect === 'autoClick') {
                    this.autoClickInterval = setInterval(() => this.addScore(this.selectedCharacter.value), 1000);
                }
            },
            populateCharacterSelection() {
                this.elements.characterSelection.innerHTML = ''; // Clear previous
                this.characters.forEach(char => {
                    const card = document.createElement('div');
                    card.classList.add('character-card');
                    card.innerHTML = `<div class="character-image">${char.image}</div><div class="character-card-name">${char.name}</div><div class="character-card-desc">${char.description}</div>`;
                    card.addEventListener('click', () => {
                        this.elements.characterSelection.querySelectorAll('.character-card').forEach(c => c.classList.remove('selected'));
                        card.classList.add('selected');
                        this.selectedCharacter = char;
                    });
                    this.elements.characterSelection.appendChild(card);
                });
            },
            applyCharacterEffect() {
                this.clickValue = 1;
                this.clickCount = 0;
                this.score = 0;
                this.elements.scoreEl.textContent = 0;
                switch (this.selectedCharacter.effect) {
                    case 'clickMultiplier':
                        this.clickValue *= this.selectedCharacter.value;
                        if (this.selectedCharacter.id === 'alpaca') this.clickValue = Math.max(1, this.clickValue - 1);
                        break;
                    case 'baseClickUp': this.clickValue += this.selectedCharacter.value; break;
                    case 'reduceTarget': this.targetScore *= this.selectedCharacter.value; break;
                    case 'targetBonus': this.targetScore *= this.selectedCharacter.value; break;
                }
            },
            addScore(amount) {
                if (!this.gameActive) return;
                this.score += amount;
                this.elements.scoreEl.textContent = Math.floor(this.score);
                
                if (this.score >= this.targetScore) {
                    if(this.selectedCharacter && this.selectedCharacter.effect === 'targetBonus') this.score *= 1.2;
                    this.gameActive = false;
                    if(this.autoClickInterval) clearInterval(this.autoClickInterval);
                    this.elements.scoreEl.textContent = Math.floor(this.score);
                    setTimeout(() => {
                        alert(`ÁõÆÊ®ôÈÅîÊàêÔºÅ„Åä„ÇÅ„Åß„Å®„ÅÜÔºÅ\nÊúÄÁµÇ„Çπ„Ç≥„Ç¢: ${Math.floor(this.score)}`);
                        this.showFortune();
                    }, 100);
                }
            },
            showFortune() {
                const fortunes = [
                    { rank: 'Â§ßÂêâ', comment: '„Åô„Åπ„Å¶„ÅåÊúÄÈ´ò„Å´„ÅÜ„Åæ„Åè„ÅÑ„ÅèÊó•ÔºÅ' }, { rank: '‰∏≠Âêâ', comment: '„Å°„Çá„Å£„Å®ËâØ„ÅÑ„Åì„Å®„Åå„ÅÇ„Çã„Åã„ÇÇÔºü' },
                    { rank: 'Âêâ', comment: 'Âπ≥Á©è„Å™‰∏ÄÊó•„ÇíÈÅé„Åî„Åõ„Åù„ÅÜ„ÄÇ' }, { rank: 'Â∞èÂêâ', comment: 'Ê≤πÊñ≠„ÅØÁ¶ÅÁâ©„ÄÇ„Åß„ÇÇÊÇ™„Åè„Å™„ÅÑÊó•„ÄÇ' },
                    { rank: 'Âá∂', comment: '‰ªäÊó•„ÅØÊÖéÈáç„Å´Ë°åÂãï„Åó„Çà„ÅÜ‚Ä¶' }
                ];
                const result = fortunes[Math.floor(Math.random() * fortunes.length)];
                
                document.getElementById('fortune-rank').textContent = result.rank;
                document.getElementById('fortune-comment').textContent = result.comment;
                showOverlay(fortuneOverlay, true);
            },
            onBalloonClick() {
                if (!this.gameActive) return;
                this.playClickEffect();
                let currentClickValue = this.clickValue;
                if(this.selectedCharacter?.effect === 'superClick' && (this.clickCount + 1) % this.selectedCharacter.value === 0) {
                    currentClickValue *= 10;
                }
                this.addScore(currentClickValue);
                this.clickCount++;
                
                if (this.selectedCharacter) {
                    switch(this.selectedCharacter.effect) {
                        case 'bonusOnClick':
                            if (this.clickCount > 0 && this.clickCount % this.selectedCharacter.value === 0) {
                                this.addScore(this.clickValue * 20);
                            } break;
                        case 'randomBonus':
                            if (Math.random() < this.selectedCharacter.value) {
                                this.addScore(this.clickValue * 200);
                            } break;
                    }
                }
            },
            processWordInput() {
                if (this.wordInput.length > 0) {
                    this.addScore(this.wordInput.length * 5);
                    this.wordInput = '';
                    this.elements.typingDisplay.textContent = this.wordInput;
                }
            },
            playClickEffect() {
                for (let i = 0; i < 20; i++) {
                    const p = document.createElement('div');
                    p.classList.add('particle');
                    this.elements.balloonContainer.appendChild(p);
                    const size = Math.random()*15+5; p.style.width=`${size}px`; p.style.height=`${size}px`;
                    p.style.background = `hsl(${Math.random()*360}, 100%, 70%)`;
                    const angle = Math.random()*360, dist=Math.random()*100+50;
                    const x = Math.cos(angle * Math.PI / 180) * dist, y = Math.sin(angle * Math.PI / 180) * dist;
                    p.animate([
                        { transform: 'translate(-50%, -50%) scale(1)', opacity: 1 },
                        { transform: `translate(calc(-50% + ${x}px), calc(-50% + ${y}px)) scale(0)`, opacity: 0 }
                    ], { duration: Math.random()*800+500, easing: 'cubic-bezier(0.1, 0.7, 1.0, 0.1)' })
                    .onfinish = () => p.remove();
                }
            },
            getCheatScore() {
                let base = 10000;
                if(this.selectedCharacter?.effect === 'cheatUp') base *= this.selectedCharacter.value;
                return base;
            },
            setup() {
                this.populateCharacterSelection();
                this.elements.runButton.addEventListener('click', () => this.run());
                this.elements.balloonContainer.addEventListener('click', () => this.onBalloonClick());
            }
        };

        // --- Global Setup ---
        document.getElementById('start-clicker-game-btn').onclick = () => {
            showOverlay(modeSelectionOverlay, false);
            clickerGame.init();
        };
        document.getElementById('start-number-game-btn').onclick = () => {
            showOverlay(modeSelectionOverlay, false);
            numberGame.init();
        };

        clickerGame.setup();
        numberGame.setup();
        showOverlay(modeSelectionOverlay, true);
        
        let cheatMode = false;
        let cheatAutoInterval = null;
        function setupCheatPanel() {
            document.getElementById('cheat-add-score').onclick = () => clickerGame.addScore(clickerGame.getCheatScore());
            
            const powerInput = document.getElementById('cheat-click-power');
            powerInput.value = clickerGame.clickValue;
            powerInput.onchange = () => { clickerGame.clickValue = parseFloat(powerInput.value) || 1; };

            const autoClickSlider = document.getElementById('cheat-auto-click');
            autoClickSlider.oninput = () => {
                if (cheatAutoInterval) clearInterval(cheatAutoInterval);
                if (clickerGame.autoClickInterval) { clearInterval(clickerGame.autoClickInterval); clickerGame.autoClickInterval = null; }
                
                const interval = parseInt(autoClickSlider.value);
                if(interval < 2000) {
                    cheatAutoInterval = setInterval(() => clickerGame.elements.balloonContainer.click(), interval);
                }
            };
        }

        document.addEventListener('keydown', (e) => {
            if (activeGame === null && !/^[q]$/.test(e.key)) return;

            if (e.key === 'Enter') {
                if(activeGame === clickerGame && clickerGame.gameActive) clickerGame.processWordInput();
                return;
            }
            if (e.key === 'Backspace') {
                if(activeGame === clickerGame && clickerGame.gameActive) clickerGame.wordInput = clickerGame.wordInput.slice(0, -1);
                clickerGame.cheatInput = clickerGame.cheatInput.slice(0, -1);
            } else if (e.key.length === 1 && !e.ctrlKey && !e.altKey && !e.metaKey) {
                const key = e.key.toLowerCase();
                if(activeGame === clickerGame && clickerGame.gameActive) clickerGame.wordInput += key;
                clickerGame.cheatInput += key;
            }
            
            if(activeGame === clickerGame && clickerGame.gameActive) clickerGame.elements.typingDisplay.textContent = clickerGame.wordInput;

            if (clickerGame.cheatInput.endsWith('qqq')) {
                if(activeGame) activeGame.gameActive = false;
                if(clickerGame.autoClickInterval) clearInterval(clickerGame.autoClickInterval);
                if(cheatAutoInterval) clearInterval(cheatAutoInterval);
                document.body.classList.add('shake-screen');
                setTimeout(startCredits, 800);
                clickerGame.cheatInput = '';
                return;
            }
            if (clickerGame.cheatInput.endsWith('qq')) {
                cheatMode = !cheatMode;
                settingsPanel.style.display = cheatMode ? 'block' : 'none';
                if(cheatMode && activeGame === clickerGame) setupCheatPanel();
                else if (cheatAutoInterval) { clearInterval(cheatAutoInterval); cheatAutoInterval = null; }
                clickerGame.cheatInput = '';
                return;
            }
        });

    </script>
</body>
</html>
